# 004 DNS

## Status

In progress

## Context

curently main local domain DNS is located on NAS.

goal:

- avoid DNS outtage in case of NAS reboot (my synology have 10 years and is a litle long to reboot) morever during NAS reboot we lost the adblock DNS in the nomad cluster because nomad depend of the NFS share.
- remove the direct redirection to service.consul DNS and the IPTABLE rule use to redirect port 53 on consul on gerard instead new DNS could be forward directly to an active consul node on port 8300

### DNS software

need DHCP Dynamic update
could redirect domain on other port than port 53

## Decision

we will migrate Main Domain DNS from NAS to gerard  (powerDNS)
powerDNS provide two disting binaries one for authority server one other for recursor
goal is to first migrate the recursice part from synology to a physical service
and in second time migrate authority server in nmad cluster

## Consequences

before to move authority server need to remove DB dns dependance (create db consul services)
need to delete the iptable rule on gerard before deploy
